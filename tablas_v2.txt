CREATE TABLE CLIENTE(
    ID_CLIENTE NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT CLIENTE_ID_CLIENTE_PK PRIMARY KEY,
    METODO_PAGO VARCHAR2(16)
    CONSTRAINT CLIENTE_METODO_PAGO_UK UNIQUE
    CONSTRAINT CLIENTE_METODO_PAGO_NN NOT NULL,
    CONTRASENIA VARCHAR(20)
    CONSTRAINT CLIENTE_CONTRASENIA_NN NOT NULL,
    NOMBRE VARCHAR2(50)
    CONSTRAINT CLIENTE_NOMBRE_NN NOT NULL,
    PRIMER_APELLIDO VARCHAR2(50)
    CONSTRAINT CLIENTE_PRIMER_APELLIDO_NN NOT NULL,
    SEGUNDO_APELLIDO VARCHAR2(50)
    CONSTRAINT CLIENTE_SEGUNDO_APELLIDO_NN NOT NULL,
    CORREO VARCHAR2(50)
    CONSTRAINT CLIENTE_CORREO_UK UNIQUE
    CONSTRAINT CLIENTE_CORREO_NN NOT NULL,
    TELEFONO NUMBER(10)
    CONSTRAINT CLIENTE_TELEFONO_UK UNIQUE
    CONSTRAINT CLIENTE_TELEFONO_NN NOT NULL,
    ID_MEMBRESIA NUMBER(5)
    CONSTRAINT CLIENTE_MEMBRESIA_FK REFERENCES MEMBRESIA(ID_MEMBRESIA)
);
SELECT * FROM CLIENTE;

CREATE TABLE MEMBRESIA(
    ID_MEMBRESIA NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT MEMBRESIA_ID_MEMBRESIA_PK PRIMARY KEY,
    TIPO VARCHAR2(10)
    CONSTRAINT MEMBRESIA_TIPO_NN NOT NULL
    CONSTRAINT MEMBRESIA_TIPO_CHK CHECK(TIPO IN ('NORMAL','PLATINO','DIAMANTE'))
);
INSERT INTO MEMBRESIA (TIPO) VALUES ('NORMAL');
INSERT INTO MEMBRESIA (TIPO) VALUES ('PLATINO');
INSERT INTO MEMBRESIA (TIPO) VALUES ('DIAMANTE');
SELECT * FROM MEMBRESIA;

CREATE TABLE COMPRA(
    ID_COMPRA NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT COMPRA_ID_COMPRA_PK PRIMARY KEY,
    TOTAL NUMBER(5)
    CONSTRAINT COMPRA_TOTAL_NN NOT NULL
    CONSTRAINT COMPRA_TOTAL_CHK CHECK(TOTAL>0),
    FECHA DATE 
    CONSTRAINT COMPRA_FECHA_NN NOT NULL
);

CREATE TABLE CLIENTE_COMPRA(
    ID_CLIENTE NUMBER(5)
    CONSTRAINT CLIENTE_COMPRA_ID_CLIENTE_FK REFERENCES CLIENTE(ID_CLIENTE)
    CONSTRAINT CLIENTE_COMPRA_ID_CLIENTE_NN NOT NULL,
    ID_COMPRA NUMBER(5)
    CONSTRAINT CLIENTE_COMPRA_ID_COMPRA_FK REFERENCES COMPRA(ID_COMPRA)
    CONSTRAINT CLIENTE_COMPRA_ID_COMPRA_NN NOT NULL
    CONSTRAINT CLIENTE_COMPRA_ID_PK PRIMARY KEY(ID_CLIENTE, ID_COMPRA)
);

CREATE TABLE ASIENTO(
    ID_ASIENTO CHAR(3)
    CONSTRAINT ASIENTO_ID_ASIENTO_PK PRIMARY KEY,
    FILA NUMBER(2)
    CONSTRAINT ASIENTO_FILA_NN NOT NULL
    CONSTRAINT ASIENTO_FILA_CHK CHECK(FILA>0),
    COLUMNA CHAR(1)
    CONSTRAINT ASIENTO_COLUMNA_NN NOT NULL
);

CREATE TABLE TIPO_BOLETO(
    ID_TIPO NUMBER(1)
    CONSTRAINT TIPO_BOLETO_ID_TIPO_PK PRIMARY KEY,
    PRECIO NUMBER(6,2)
    CONSTRAINT TIPO_BOLETO_PRECIO_NN NOT NULL
    CONSTRAINT TIPO_BOLERO_PRECIO_CHK CHECK(PRECIO>0)
);

CREATE TABLE SUCURSAL(
    ID_SUCURSAL NUMBER(5)
    CONSTRAINT SUCURSAL_ID_SUCURSAL_PK PRIMARY KEY,
    CIUDAD VARCHAR2(30)
    CONSTRAINT SUCURSAL_CIUDAD_NN NOT NULL
);

CREATE TABLE SALA(
    ID_SALA NUMBER(5)
    CONSTRAINT SALA_ID_SALA_PK PRIMARY KEY,
    TIPO VARCHAR2(6)
    CONSTRAINT SALA_TIPO_NN NOT NULL
    CONSTRAINT SALA_TIPO_CHK CHECK(TIPO IN ('NORMAL','VIP')),
    ID_SUCURSAL NUMBER(5)
    CONSTRAINT SALA_ID_SUCURSAL_FK REFERENCES SUCURSAL(ID_SUCURSAL)
    CONSTRAINT SALA_ID_SUCURSAL_NN NOT NULL
);

CREATE TABLE PELICULA(
    ID_PELICULA NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT PELICULA_ID_PELICULA_PK PRIMARY KEY,
    NOMBRE VARCHAR2(50)
    CONSTRAINT PELICULA_NOMBRE_NN NOT NULL,
    RESUMEN VARCHAR2(500)
    CONSTRAINT PELICULA_RESUMEN_NN NOT NULL,
    CLASIFICACION CHAR(3)
    CONSTRAINT PELICULA_CLASIFICACION_NN NOT NULL,
    TRAILER BLOB
    CONSTRAINT PELICULA_TRAILER_NN NOT NULL,
    DURACION NUMBER(3)
    CONSTRAINT PELICULA_DURACION_NN NOT NULL
    CONSTRAINT PELICULA_DURACION_CHK CHECK(DURACION>0),
    POSTER BLOB
    CONSTRAINT PELICULA_POSTER_NN NOT NULL,
    GENERO VARCHAR2(50)
    CONSTRAINT PELICULA_GENERO_NN NOT NULL
);

CREATE TABLE FUNCION(
    ID_FUNCION NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT FUNCION_ID_FUNCION_PK PRIMARY KEY,
    FECHA DATE DEFAULT SYSDATE
    CONSTRAINT FUNCION_FECHA_NN NOT NULL,
    HORA VARCHAR2(5)
    CONSTRAINT FUNCION_HORA_NN NOT NULL,
    ASIENTOS_TOTAL NUMBER(3)
    CONSTRAINT FUNCION_ASIENTOS_TOTAL_NN NOT NULL
    CONSTRAINT FUNCION_ASIENTOS_TOTAL_CHK CHECK(ASIENTOS_TOTAL<6),
    ID_SUCURSAL NUMBER(5)
    CONSTRAINT FUNCION_ID_SUCURSAL_FK REFERENCES SUCURSAL(ID_SUCURSAL)
    CONSTRAINT FUNCION_ID_SUCURSAL_NN NOT NULL,
    ID_PELICULA NUMBER(5)
    CONSTRAINT FUNCION_ID_PELICULA_FK REFERENCES PELICULA(ID_PELICULA)
    CONSTRAINT FUNCION_ID_PELICULA_NN NOT NULL,
    ID_SALA NUMBER(5)
    CONSTRAINT FUNCION_ID_SALA_FK REFERENCES SALA(ID_SALA)
    CONSTRAINT FUNCION_ID_SALA_NN NOT NULL
);

CREATE TABLE FUNCION_ASIENTO(
    ID_FUNCION NUMBER(5)
    CONSTRAINT FUNCION_ASIENTO_ID_FUNCION_FK REFERENCES FUNCION(ID_FUNCION)
    CONSTRAINT FUNCION_ASIENTO_ID_FUNCION_NN NOT NULL,
    ID_ASIENTO CHAR(3)
    CONSTRAINT FUNCION_ID_ASIENTO_FK REFERENCES ASIENTO(ID_ASIENTO)
    CONSTRAINT FUNCION_ID_ASIENTO_NN NOT NULL,
    ASIENTOS_DISPONIBLES CHAR(1)
    CONSTRAINT FUNCION_ASIENTO_CHK CHECK(ASIENTOS_DISPONIBLES IN (0, 1))
);

CREATE TABLE BOLETO(
    ID_BOLETO NUMBER(5) GENERATED ALWAYS AS IDENTITY
    CONSTRAINT BOLETO_ID_BOLETO_PK PRIMARY KEY,
    DESCUENTO CHAR(1)
    CONSTRAINT BOLETO_DESCUENTO_NN NOT NULL,
    ID_SUCURSAL NUMBER(5)
    CONSTRAINT BOLETO_ID_SUCURSAL_FK REFERENCES SUCURSAL(ID_SUCURSAL)
    CONSTRAINT BOLETO_ID_SUCURSAL_NN NOT NULL,
    ID_PELICULA NUMBER(5)
    CONSTRAINT BOLETO_ID_PELICULA_FK REFERENCES PELICULA(ID_PELICULA)
    CONSTRAINT BOLETO_ID_PELICULA_NN NOT NULL,
    ID_SALA NUMBER(2)
    CONSTRAINT BOLETO_ID_SALA_FK REFERENCES SALA(ID_SALA)
    CONSTRAINT BOLETO_ID_SALA_NN NOT NULL,
    ID_ASIENTO CHAR(3)
    CONSTRAINT BOLETO_ID_ASIENTO_FK REFERENCES ASIENTO(ID_ASIENTO)
    CONSTRAINT BOLETO_ID_ASIENTO_NN NOT NULL,
    ID_COMPRA NUMBER(5)
    CONSTRAINT BOLETO_ID_COMPRA_FN REFERENCES COMPRA(ID_COMPRA)
    CONSTRAINT BOLETO_ID_COMPRA_NN NOT NULL,
    ID_FUNCION NUMBER(5)
    CONSTRAINT BOLETO_ID_FUNCION_FK REFERENCES FUNCION(ID_FUNCION)
    CONSTRAINT BOLETO_ID_FUNCION_NN NOT NULL,
    ID_TIPO_BOLETO NUMBER(1)
    CONSTRAINT BOLETO_ID_TIPO_BOLETO_FK REFERENCES TIPO_BOLETO(ID_TIPO)
    CONSTRAINT BOLETO_ID_TIPO_BOLETO_NN NOT NULL
   ); 
   